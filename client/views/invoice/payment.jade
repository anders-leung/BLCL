//
   Created by ander on 2017-11-01.

extends ../layout

block content
    script(type='text/javascript', src='/js/datatables/jquery.dataTables.min.js')
    script(type='text/javascript', src='/js/datatables/dataTables.buttons.min.js')
    script(type='text/javascript', src='/js/datatables/jszip.min.js')
    script(type='text/javascript', src='/js/datatables/buttons.html5.min.js')
    script(type='text/javascript', src='/js/datatables/datatables-sum.js')
    script(type='text/javascript', src='/js/invoice/payment.js')

    .row
        .col-4.form-group
            label(for='weeks') Week of
            select#weeks.form-control(name='weeks')
                each week in weeks
                    option(value=week)=week
        .col-4.form-group
            label(for='company') Company
            select#company.form-control(name='company')
                option(value='blcl') Benjamin Leung & Co., Ltd.
                option(value='cantrust') Cantrust Business Service Ltd.

    #table.col-12.tab-content
        table.cell-border(style='width: 100%')
            thead
                tr
                    th
                    th Pyt Date
                    th #
                    th Client Name
                    th Remarks
                    th Total Received
                    th ADV
                    th INV
                    th CA
                    th CHQ
                    th DD
                    th ET
            tfoot
                tr
                    th
                    th
                    th
                    th
                    th
                    th
                    th
                    th
                    th
                    th
                    th
                    th
            tbody
                each invoice in invoices
                    tr
                        td=invoice._id
                        td=convertDate(invoice.pytDate)
                        - var client = invoice.client;
                        if client
                            - client = client.name
                        else
                            - client = invoice.oneTimeClient.name

                        td.text-nowrap #{invoice.number}
                        td.text-nowrap #{client}
                        td.text-nowrap=invoice.remarks
                        td.text-nowrap=invoice.total
                        td.text-nowrap #{invoice.pytReceived == 'ADV' ? invoice.total : ''}
                        td.text-nowrap #{invoice.pytReceived == 'INV' ? invoice.total : ''}
                        td.text-nowrap #{invoice.pytReceived == 'CA' ? invoice.total : ''}
                        td.text-nowrap #{invoice.pytReceived == 'CK' || invoice.pytReceived == 'CHQ' ? invoice.total : ''}
                        td.text-nowrap #{invoice.pytReceived == 'DD' ? invoice.total : ''}
                        td.text-nowrap #{invoice.pytReceived == 'ET' ? invoice.total : ''}